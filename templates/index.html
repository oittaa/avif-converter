<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>{{ title }}</title>
      <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
      <style>
         html{height:90%}body{height:100%;background-color:#2590eb;color:#333}h1,h2{text-align:center}footer{position:fixed;left:0;bottom:0;height:30px;width:100%}.btn{background-color:#4169e1;border:none;color:#fff;padding:12px 16px;font-size:16px;cursor:pointer}.btn:hover{background-color:#1e90ff}.wrapper{width:100%;height:35%;display:flex;align-items:center;justify-content:center}.wrapper .file-upload{height:200px;width:200px;border-radius:100px;position:relative;display:flex;justify-content:center;align-items:center;border:4px solid #fff;overflow:hidden;background-image:linear-gradient(to bottom,#2590eb 50%,#fff 50%);background-size:100% 200%;transition:all 1s;color:#fff;font-size:100px}.wrapper .file-upload input[type=file]{height:200px;width:200px;position:absolute;top:0;left:0;opacity:0;cursor:pointer}.wrapper .file-upload:hover{background-position:0 -100%;color:#2590eb}.api-info{display:none;padding-bottom:2em}input[type=url]{max-width:800px;padding:12px 20px;margin:8px 0;display:inline-block;border:1px solid #ccc;border-radius:4px;box-sizing:border-box}
      </style>
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" integrity="sha512-HK5fgLBL+xu6dm/Ii3z4xhlSUyZgTT9tuc/hSrtw6uzJOvgRr2a9jyxxT1ely+B+xFAmJKVSTbpM/CuL7qxO8w==" crossorigin="anonymous" />
   </head>
   <body>
      <div class="wrapper">
         <div class="file-upload">
            <form method="post" enctype="multipart/form-data" action="{{ url_for('api_post') }}">
               <input type="file" name="file" onfocus="giveOnchangeEvent(this)">
               <i class="fa fa-arrow-up"></i>
            </form>
         </div>
      </div>
      <div class="wrapper">
          <form method="get" action="{{ url_for('api_get') }}">
             <input autofocus type="url" name="url" id="url" placeholder="https://..." autocomplete="off" onpaste="delaySubmit(this)">
             <input class="btn" type="submit" value="Go">
          </form>
      </div>
      <h1><a href="#" onclick="toggle_visibility('api-info');">API</a></h1>
      <div id="api-info" class="api-info">
         <h2>Python</h2>
         <div style="margin:auto;background: #f0f0f0; overflow:auto;max-width: 800px;border:solid #00008B;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
            <pre style="margin: 0; line-height: 125%"><span style="color: #007020; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">requests</span>

url <span style="color: #666666">=</span> <span style="color: #4070a0">&#39;{{ url }}api&#39;</span>
input_file <span style="color: #666666">=</span> <span style="color: #4070a0">&#39;/path/to/image.jpg&#39;</span>
output_file <span style="color: #666666">=</span> <span style="color: #4070a0">&#39;/path/to/image.avif&#39;</span>

r <span style="color: #666666">=</span> requests<span style="color: #666666">.</span>post(url, files<span style="color: #666666">=</span>{<span style="color: #4070a0">&#39;file&#39;</span>: <span style="color: #007020">open</span>(input_file,<span style="color: #4070a0">&#39;rb&#39;</span>)})
<span style="color: #007020; font-weight: bold">if</span> r<span style="color: #666666">.</span>status_code <span style="color: #666666">==</span> requests<span style="color: #666666">.</span>codes<span style="color: #666666">.</span>ok <span style="color: #007020; font-weight: bold">and</span> r<span style="color: #666666">.</span>headers<span style="color: #666666">.</span>get(<span style="color: #4070a0">&#39;Content-Type&#39;</span>) <span style="color: #666666">==</span> <span style="color: #4070a0">&#39;image/avif&#39;</span>:
    <span style="color: #007020; font-weight: bold">with</span> <span style="color: #007020">open</span>(output_file, <span style="color: #4070a0">&#39;wb&#39;</span>) <span style="color: #007020; font-weight: bold">as</span> f:
        f<span style="color: #666666">.</span>write(r<span style="color: #666666">.</span>content)
<span style="color: #007020; font-weight: bold">else</span>:
    <span style="color: #007020">print</span>(<span style="color: #4070a0">&#39;error&#39;</span>)
</pre>
         </div>
         <br>
         <div style="margin:auto;background: #f0f0f0; overflow:auto;max-width: 800px;border:solid #00008B;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
            <pre style="margin: 0; line-height: 125%"><span style="color: #007020; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">requests</span>

url <span style="color: #666666">=</span> <span style="color: #4070a0">&#39;{{ url }}api&#39;</span>
input_url <span style="color: #666666">=</span> <span style="color: #4070a0">&#39;{{ url }}static/flowers.jpg&#39;</span>
output_file <span style="color: #666666">=</span> <span style="color: #4070a0">&#39;/path/to/flowers.avif&#39;</span>

r <span style="color: #666666">=</span> requests<span style="color: #666666">.</span>get(url, params<span style="color: #666666">=</span>{<span style="color: #4070a0">&#39;url&#39;</span>: input_url})
<span style="color: #007020; font-weight: bold">if</span> r<span style="color: #666666">.</span>status_code <span style="color: #666666">==</span> requests<span style="color: #666666">.</span>codes<span style="color: #666666">.</span>ok <span style="color: #007020; font-weight: bold">and</span> r<span style="color: #666666">.</span>headers<span style="color: #666666">.</span>get(<span style="color: #4070a0">&#39;Content-Type&#39;</span>) <span style="color: #666666">==</span> <span style="color: #4070a0">&#39;image/avif&#39;</span>:
    <span style="color: #007020; font-weight: bold">with</span> <span style="color: #007020">open</span>(output_file, <span style="color: #4070a0">&#39;wb&#39;</span>) <span style="color: #007020; font-weight: bold">as</span> f:
        f<span style="color: #666666">.</span>write(r<span style="color: #666666">.</span>content)
<span style="color: #007020; font-weight: bold">else</span>:
    <span style="color: #007020">print</span>(<span style="color: #4070a0">&#39;error&#39;</span>)
</pre>
         </div>
         <h2>Shell</h2>
         <div style="margin:auto;background: #f0f0f0; overflow:auto;max-width: 800px;border:solid #00008B;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
            <pre style="margin: 0; line-height: 125%">curl --output /path/to/image.avif -F <span style="color: #4070a0">&quot;file=@/path/to/image.jpg&quot;</span> {{ url }}api
</pre>
         </div>
         <h2>HTML</h2>
         <div style="margin:auto;background: #f0f0f0; overflow:auto;max-width: 800px;border:solid #00008B;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
            <pre style="margin: 0; line-height: 125%"><span style="color: #062873; font-weight: bold">&lt;picture&gt;</span>
	<span style="color: #062873; font-weight: bold">&lt;source</span> <span style="color: #4070a0">srcset=&quot;{{ url }}api?url={{ url|urlencode }}static/flowers.jpg&quot;</span> <span style="color: #4070a0">type=&quot;image/avif&quot;</span><span style="color: #062873; font-weight: bold">&gt;</span>
	<span style="color: #062873; font-weight: bold">&lt;img</span> <span style="color: #4070a0">src=&quot;{{ url }}static/flowers.jpg&quot;</span> <span style="color: #4070a0">alt=&quot;flowers&quot;</span><span style="color: #062873; font-weight: bold">&gt;</span>
<span style="color: #062873; font-weight: bold">&lt;/picture&gt;</span>
</pre>
         </div>
      </div>
      <footer>&nbsp;<a href="https://github.com/oittaa/avif-converter"><i class="fab fa-github"></i></a></footer>
      <script>
         function giveOnchangeEvent(input) {
             input.onchange = function() {
                 input.form.submit();
             }
         }
         function delaySubmit(input, delay = 50) {
             setTimeout(function() {
                 input.form.submit();
             }, delay);
         }
         function toggle_visibility(id) {
             var e = document.getElementById(id);
             if(e.style.display == 'block')
                 e.style.display = 'none';
             else
                 e.style.display = 'block';
         }
      </script>
   </body>
</html>
